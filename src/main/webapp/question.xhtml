<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://xmlns.jcp.org/jsf/html"
	xmlns:c="http://xmlns.jcp.org/jsf/core"
	xmlns:f="http://java.sun.com/jsf/facelets"
	xmlns:p="http://primefaces.org/ui"
	xmlns:jf="http://java.sun.com/jsp/jstl/functions"
	xmlns:jc="http://java.sun.com/jsp/jstl/core">

<f:composition template="index.xhtml">
	<f:define name="content">
			<h:dataTable value="#{questionController.questions}" var="question" class="table table-striped" width="60%" id="questionTable">
			    <h:column headerClass="col1" >
			    <h:form>
			    	<h:commandLink  value="#{question.user.username}" action="qtuser" />        
			        </h:form>
			    </h:column>
			    <h:column headerClass="col2" >
			    <h:form>
			        <h:commandLink  value="#{question.title}" action="answer" >
			            <c:setPropertyActionListener value="#{question}" target="#{questionController.question}" />
			        </h:commandLink>
			        
			            <br/>
			            <div style="max-height: 10px;">
			            <h:outputText value="#{jf:substring(question.content, 0, 100)}..." escape="false"/>	
			            </div>	            		            
			   </h:form>   
			    </h:column>			             
			</h:dataTable>
			
			<hr/>
			<form>
			<p:commandButton value="Ask Question"
				action="#{questionController.clear()}" update=":questionForm"
				oncomplete="PF('questionDialog').show()" resetValues="true" />
			</form>
			
			<p:dialog widgetVar="questionDialog" closeOnEscape="true" modal="true" showEffect="fade" hideEffect="fade" width="800" height="400"
			header="Question">
			<h:form id="questionForm">
			<p:panelGrid columns="2" styleClass="myridd">
					title : 
					<p:inputTextarea rows="2" cols="33" autoResize="false" value="#{questionController.question.title}"/>
					content :  
					<p:editor id="editor" widgetVar="editorWidget"
					value="#{questionController.question.content}" width="600" />
				<br />
				<p:commandButton value="Post your Question" action="#{questionController.save()}"
							update="questionForm, :questionTable"
							styleClass="ui-priority-primary"
							oncomplete="handleDialogSubmit(args, 'questionDialog')" style="width:100; height:30" />
			</p:panelGrid>
			</h:form>
			</p:dialog>

	<p:messages id="message" />
		
		<script type="text/javascript">
    		function handleDialogSubmit(args, dialogName) {
        		if (!args.validationFailed) {
            		PF(dialogName).hide();
        		}
    		}
		</script>

		
	</f:define>
</f:composition>

</html>

